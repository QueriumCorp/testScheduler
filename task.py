###############################################################################
# task.py
# Handle tasks
###############################################################################
import dbConn
import logging

###############################################################################
# Support functions
###############################################################################

#######################################
# xxxxx
#######################################

###############################################################################
# Main logic
###############################################################################
def next():
    data = dbConn.getRow(
        "testSchedule", ["status"], ["pending"],
        dbConn.getFields("testSchedule"))
    if data is None or len(data)<1:
        logging.debug("No pending tasks")
        return []

    return dbConn.mkObj(dbConn.getFields("testSchedule"), data)